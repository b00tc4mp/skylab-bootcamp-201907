/* Pasapalabra Game! (Final JS) üéÆ
!?
Resource: ‚Äã https://www.youtube.com/watch?v=xJp2c_rcHDc
Haz el juego del Pasapalabra, el programa deber√° lanzar la definici√≥n de una
palabra y el usuario deber√° adivinar qu√© palabra estamos tratando, por ejemplo:
'>>>'With the letter "M", Capital of Spain, located in the center of the country.
'>>>' "Madrid"
'>>>'Correct, you have 1 Point!
Tu juego deber√≠a hacer una pregunta por cada letra del alfabeto, al final del juego, y
habiendo respondido todas las letras, deber√° indicarle al usuario cuantas letras ha
fallado y cu√°ntas ha acertado. Si el usuario responde con "pasapalabra" el juego
deber√° estar preparado para entender que en ese momento, el usuario no
responder√° esa pregunta, y no estar√° acertada ni fallada, la dejar√° para la siguiente
ronda. El juego deber√°, cuando finalice, mostrar un ranking de usuarios con el
nombre y ordenados por cantidad de letras acertadas. */


/* PRO
‚óè El programa no deber√≠a hacer distinciones entre may√∫sculas, min√∫sculas...
Ejemplo : ‚Äã "animal" == "ANIMAL" // "Animal" // "aNiMal"...
‚óè El programa debe estar preparado para aceptar el input "END" para terminar
el juego en cualquier momento, si esto sucede, el programa dir√° cu√°ntas
letras ha acertado pero no entrar√° en el ranking.
‚óè Prepara tu programa para que no repita siempre las mismas preguntas, por
ejemplo, de la misma letra, se podr√≠an hacer tres preguntas diferentes.
 */

var questions = [
	{letter: "a", answer: {
        a:"abducir",
        b:"anterior", 
        c:"armario"
        }, 
        status:0,
        question: {
        a: ("CON LA A. Dicho de una supuesta criatura extraterrestre: Apoderarse de alguien"),
        b:("CON LA A. Lo contrario de posterior"),
        c:("CON LA A. Pieza de mobiliario que puedes encontrar en IKEA y en tu habitaci√≥n")
    }
    },
	{letter: "b", answer: {
        a: "bingo",
        b:"banana",
        c:"barcelona"
    }, status: 0, 
    question:{
        a: ("CON LA B. Juego que ha sacado de quicio a todos los 'Skylabers' en las sesiones de precurso"),
        b:("CON LA B. Fruta amarilla tropical"),
        c:("CON LA B. Ciudad d√≥nde se realiza el bootcamp Skylab coders")
    }},

    {letter: "c", answer: { 
    a:"churumbel",
    b:"cadiz", 
    c:"camaron"
    }, 
    status:0,
    question: {
    a: ("CON LA C. Ni√±o, cr√≠o, beb√©"),
    b:("CON LA C. La ciudad conocida con la tacita de plata"),
    c:("CON LA C. Sigue la letra de Estopa: yo me parto la camisa como ...")
}
},
	{letter: "d", answer: {
        a:"dinamarca",
        b:"dios", 
        c:"dante"
        }, 
        status:0,
        question: {
        a: ("CON LA D. Pa√≠s n√≥rdico lim√≠trofe con Alemania"),
        b:("CON LA D. Ente ininteligible, omnisciente e inmutable"),
        c:("CON LA D. Autor de La Divina Comedia")
    }
    },
	{letter: "e",answer: {
        a:"ecuador",
        b:"estrecho", 
        c:"estrella"
        }, 
        status:0,
        question: {
        a: ("CON LA E. Linea imaginaria que divide la Tierra en dos hemisferios "),
        b:("CON LA E. Canal de agua situado entre dos masas de tierra que conecta dos cuerpos de agua"),
        c:("CON LA E. Cuerpo astr√≥mico")
    }
    },
	{letter: "f", answer: {
        a:"francia",
        b:"famoso", 
        c:"fallo"
        }, 
        status:0,
        question: {
        a: ("CON LA F. Pa√≠s que introdujo el emblema Libertad, Igualdad y Fraternidad"),
        b:("CON LA F. Persona muy conocida (en masculino)"),
        c:("CON LA F. Seguro que has tenido m√°s de uno en estas preguntas")
    }
    },
	{letter: "g", answer: {
        a:"gorila",
        b:"galicia", 
        c:"granada"
        }, 
        status:0,
        question: {
        a: ("CON LA G. El primate m√°s grande que existe"),
        b:("CON LA G. Tierra d√≥nde se acababa el occidente durante el mundo medieval"),
        c:("CON LA G. Ciudad d√≥nde se encuentra La Alhambra")
    }
    },
	{letter: "h", answer: {
        a:"hermano",
        b:"habitacion", 
        c:"huelva"
        }, 
        status:0,
        question: {
        a: ("CON LA H. Familiar masculino hijo de tus mismos padres"),
        b:("CON LA H. Espacio de una casa donde suele haber una cama y un armario"),
        c:("CON LA H. Provincia d√≥nde finaliza la Romer√≠a del Roc√≠o")
    }
    },
	{letter: "i", answer: {
        a:"italia",
        b:"ira", 
        c:"incoloro"
        }, 
        status:0,
        question: {
        a: ("CON LA I. Pa√≠s con forma de bota"),
        b:("CON LA I. Emoci√≥n irracional que provoca un gran enfado"),
        c:("CON LA I. Que carece de color")
    }
    },
	{letter: "j",answer: {
        a:"jaen",
        b:"jota", 
        c:"joya"
        }, 
        status:0,
        question: {
        a: ("CON LA J. LA provincia de Espa√±a mayor productora de aceite de oliva"),
        b:("CON LA J. Baile regional aragon√©s"),
        c:("CON LA J. Adorno de oro, plata o platino, con perlas o piedras preciosas o sin ellas.")
    }
    },
	{letter: "k", answer: {
        a:"kilogramo",
        b:"karate", 
        c:"koala"
        }, 
        status:0,
        question: {
        a: ("CON LA K. Unidad b√°sica de masa a nivel internacional"),
        b:("CON LA K. Arte marcial de origen japon√©s"),
        c:("CON LA K. Marsupial t√≠pico de Australia")
    }
    },
	{letter: "l", answer: {
        a:"ley",
        b:"lago", 
        c:"libertad"
        }, 
        status:0,
        question: {
        a: ("CON LA L. Norma que rige en las sociedades avanzadas"),
        b:("CON LA L. Cuerpo de agua dulce de grandes extensiones"),
        c:("CON LA L. Valor moral y pol√≠tico muy apreciado")
    }
    },
	{letter: "m", answer: {
        a:"madrid",
        b:"mes", 
        c:"molecula"
        }, 
        status:0,
        question: {
        a: ("CON LA M. Capital de Espa√±a"),
        b:("CON LA M. Espacio de 12 periodos en el que est√° dividido un a√±o"),
        c:("CON LA M. Conjunto estable de √°tomos ")
    }
    },
	{letter: "n", answer: {
        a:"negacion",
        b:"anterior", 
        c:"navarra"
        }, 
        status:0,
        question: {
        a: ("CON LA N. Primera fase de un duelo"),
        b:("CON LA N. Famosa novela de Unamuno y fen√≥meno meteor√≥lico"),
        c:("CON LA N. Reino hist√≥rico de la pen√≠nsula ib√©rica")
    }
    },
	{letter: "√±",answer: {
        a:"ca√±a",
        b:"ca√±on", 
        c:"ri√±on"
        }, 
        status:0,
        question: {
        a: ("CONTIENE LA √ë. Planta de d√≥nde se extrae el az√∫car"),
        b:("CONTIENE LA √ë  Pieza de artiller√≠a"),
        c:("CONTIENE LA √ë. √ìrgano principal del sistema urinario humano")
    }
    },
	{letter: "o",answer: {
        a:"oscar",
        b:"ola", 
        c:"oviedo"
        }, 
        status:0,
        question: {
        a: ("CON LA O. Estatu√≠lla de la famosa gala de Hollywood"),
        b:("CON LA O. Onda que se desplaza por los mares"),
        c:("CON LA O. Capital de Asturias")
    }
    },
	{letter: "p", answer: {
        a:"perro",
        b:"principe", 
        c:"pelotari"
        }, 
        status:0,
        question: {
        a: ("CON LA P. El mejor animal de compa√±√≠a del hombre"),
        b:("CON LA P. Hijo de reyes y tambi√©n una galleta"),
        c:("CON LA P. Jugado de Pelota Vasca")
    }
    },
	{letter: "q", answer: {
        a:"queen",
        b:"quimica", 
        c:"quito"
        }, 
        status:0,
        question: {
        a: ("CON LA Q. Grupo de m√∫sica brit√°nico hist√≥rico"),
        b:("CON LA Q.  Ciencia que estudia la composici√≥n, estructura y propiedades de la materia"),
        c:("CON LA Q.  Capital de Ecuador")
    }
    },
	{letter: "r",answer: {
        a:"rima",
        b:"roma", 
        c:"revolucion"
        }, 
        status:0,
        question: {
        a: ("CON LA R. Repetici√≥n de una secuencia de fonemas a partir de la s√≠laba t√≥nica al final de dos o m√°s versos"),
        b:("CON LA R. Ciudad italiana fundada por R√≥mulo y Remo"),
        c:("CON LA R. Cambio social brusco que voltea el sistema hegem√≥nico")
    }
    },
	{letter: "s",answer: {
        a:"sevilla",
        b:"sobre", 
        c:"silencio"
        }, 
        status:0,
        question: {
        a: ("CON LA S. Ciudad que tiene un color especial"),
        b:("CON LA S. Preposici√≥n que siempre est√° encima"),
        c:("CON LA S. Ausencia de ruido")
    }
    },
	{letter: "t",answer: {
        a:"teologia",
        b:"tomate", 
        c:"titan"
        }, 
        status:0,
        question: {
        a: ("CON LA T. El estudio sobre Dios"),
        b:("CON LA T. Planta con la que se hace el salmorejo y el gazpacho"),
        c:("CON LA T. Poderosa deidad de la mitolog√≠a griega")
    }
    },
	{letter: "u", answer: {
        a:"ulises",
        b:"uruguay", 
        c:"universo"
        }, 
        status:0,
        question: {
        a: ("CON LA U. Heroe de la mitolog√≠a griega tambi√©n conocido como Odiseo"),
        b:("CON LA U. Pa√≠s sudamericano muy futbolero"),
        c:("CON LA U.  la totalidad del espacio y del tiempo, de todas las formas de la materia y la energ√≠a")
    }
    },
	{letter: "v",answer: {
        a:"violeta",
        b:"vitoria", 
        c:"verbo"
        }, 
        status:0,
        question: {
        a: ("CON LA V. Color entre azulado y rojizo"),
        b:("CON LA V. Ciudad vasca"),
        c:("CON LA V.  Categor√≠a l√©xica que expresa acci√≥n")
    }
    },
	{letter: "w", answer: {
        a:"wikipedia",
        b:"whasington", 
        c:"windows"
        }, 
        status:0,
        question: {
        a: ("CON LA W. Enciclopedia virtual editada de manera colaborativa"),
        b:("CON LA W. Capital de USA"),
        c:("CON LA W. Sistema operativo creado por Bill gates")
    }
    },
	{letter: "x",answer: {
        a:"xilofono",
        b:"existencialismo", 
        c:"extinci√≥n"
        }, 
        status:0,
        question: {
        a: ("CON LA X. Instrumento musical de percusi√≥n"),
        b:("CONTIENE LA X. Corriente filos√≥fica del siglo XIX que sigui√≥ Sartre"),
        c:("CONTIENE LA X. Desaparici√≥n de todos los miembros de una especie ")
    }
    },
	{letter: "y", answer: {
        a:"yogur",
        b:"yugoslavia", 
        c:"peyote"
        }, 
        status:0,
        question: {
        a: ("CON LA Y. Comida de origen l√°cteo que suelen comer los ni√±os"),
        b:("CON LA Y. Ex rep√∫blica balc√°nica"),
        c:("CONTIENE LA Y. Peque√±o c√°ctus conocido por sus alcaloides psicoactivos utilizado de forma ritual y medicinal por ind√≠genas americanos")
    }
    },
	{letter: "z",answer: {
        a:"zen",
        b:"zaragoza", 
        c:"zoo"
        }, 
        status: 0,
        question: {
        a: ("CON LA Z. Escuela de budismo que busca la experiencia de la sabidur√≠a m√°s all√° del discurso racional"),
        b:("CON LA Z. Capital de provincia por d√≥nde pasa el Ebro"),
        c:("CON LA Z. Instalaci√≥n en la que se exhiben animales ")
    }
    },

]

var count=1;
var statusRight=0;
var points;
var statusWrong=0;
var rankingUsers= [];
var removed;
var end=false;
var questionAsked;
var questionAsked2=[];
var valor=-1;


function pasapalabra(){

	name = prompt('¬øCu√°l es tu nombre?');
   
	console.log(`¬°Hola ${name}!`)

	//Sistema de puntos
	console.log(`El sistema de puntos es el siguiente: 
			Cada letra acertada es un punto. 
			Si fallas una palabra no se vuelve a repetir y cuenta como fallo
			Si dices pasapalabra, la letra no cuenta como fallada y se queda pendiente 
			para el siguiente turno.
			`);
			
    askQuestions();	
  

//Funci√≥n donde se hacen las preguntas y las posibles respuestas
function askQuestions(){

    //Funci√≥n que devuelve una letra aleatoria entre a,b y c
    function randomLetter(){
        // Generar Numero Random entre 0 y 2
        function numberRandom() {
            return Math.floor(Math.random() * 3); 
         }
        var oneNumberRandom= numberRandom();

        var letterArray = ['a','b','c'];

        function returnLetter (){
          return letterArray[oneNumberRandom];
        }
       return returnLetter();
    }
                   
    //Creo una variable global de la funci√≥n askquestions y que sea igual a questions para que cada 
    //invocaci√≥n a esta funci√≥n tenga un array limpio con los status a 0
    var questions2 = questions.map(x=>x);
           
    //Bucle con las preguntas por prompt
 	for (var i=0; i<questions2.length;i++) {
               
        //se llama a la funci√≥n que genera la letra aleatoria y se le asigna a una variable.
        letterVariable = randomLetter();
              
        var response;  

         //funci√≥n para controlar que se a√±ade una respuesta ya que si no, response ser√≠a nully el tolowercase no funciona

        function funcPrompt() {
        //se crea un condicional para diferenciar las preguntas pasapalabra con status 3. Si tienen otro status se pasa al else
          if (questions2[i].status===3){
            valor +=1;
           
            //En el caso de que sea una palabra que se haya dado pasapalabra
            //mostrar√© la pregunta del array una a una en orden
            response = prompt(questionAsked2[valor]);
            if (response === null || response === "") {
              alert('Por favor, introduce una respuesta');
              
              funcPrompt();
              return;
            }
       }
          else {
         //guardo la pregunta aleatoria de las tres posibles en una variable que utilizar√© m√°s adelante
          questionAsked=  questions2[i].question[letterVariable]
          response = prompt(questionAsked);
             if (response === null || response === "") {
              alert('Por favor, introduce una respuesta');
              funcPrompt();
              return;
            }
          }
        }
        funcPrompt();   

        //Convertir a min√∫sculas todas las letras que se escriban
        var responseUpper = response.toLowerCase();
  
                    
            if (responseUpper==='end'){
                count ===1 ? console.log('Has acabado con ' + (count -1) + ' punto') : console.log('Has acabado con ' + (count -1) + ' puntos');
                //cambio el valor de end a true y salgo para que no se muestre la puntuaci√≥n m√°s adelante
                end=true;
                break;
            }
            else if (responseUpper==='pasapalabra'){
                  
                questions2[i].status=3;
                
                //Hago un condicional para a√±adir a un array las preguntas que les dice pasapalabra para sacarlas
                //posteriormente cuando el bucle haya dado la vuelta. Adem√°s, lo divido seg√∫n las tres opciones de preguntas posibles
               
                 if (questionAsked===questions2[i].question.a){
                     questionAsked2.push(questions2[i].question.a);
                                      
                } else  if (questionAsked===questions2[i].question.b){
                     questionAsked2.push(questions2[i].question.b);
                     
                } else {
                     questionAsked2.push(questions2[i].question.c);
                                     
                }   
               
                //la letra que hay en el bucle cu√°ndo se pone pasapalabra
                let letterPass = questions2[i].letter;
                                
                //el √≠ndice la letra que hay en el bucle cu√°ndo se se pone pasapalabra
                function indexLetter(element) {
                    return element.letter === letterPass;
                }
                
                let letterIndex = (questions2.findIndex(indexLetter));

                //Llamo a la funci√≥n con el √≠ndice de la letra para que haga el splice del array y el push para meterlo detr√°s de todo
                newTurn(letterIndex); 

                //Al hacer el splice en la funci√≥n newTurn se saltaba un item del bucle y se saltaba un pregunta. Aqu√≠ fuerzo a que no se lo salte
                i--;
                
               
               //a√±ado tres else if para los casos de que sean preguntas preguntadas en el caso de ser pasapalabras
               //como est√°n en un array tengo que hacerlo de otra manera 
            }  else if (questionAsked2.includes(questions2[i].question.a)){
                        if(questions2[i].answer.a===responseUpper){
                            count ===1 ? console.log('Correcto, tienes ' + count + ' punto') : console.log('Correcto, tienes ' + count + ' puntos');
                            count++;
                            questions2[i].status=1;
                            statusRight += questions2[i].status===1;
                        
                       } else{
                        questions2[i].status=2;
                        statusWrong += questions2[i].status===2;
                        console.log('Error,' + response + ' no es la palabra correcta');
                       }

             }else if (questionAsked2.includes(questions2[i].question.b)){
                       if (questions2[i].answer.b===responseUpper){
                            count ===1 ? console.log('Correcto, tienes ' + count + ' punto') : console.log('Correcto, tienes ' + count + ' puntos');
                            count++;
                            questions2[i].status=1;
                            statusRight += questions2[i].status===1;
                       } 
                       else{
                        questions2[i].status=2;
                        statusWrong += questions2[i].status===2;
                        console.log('Error,' + response + ' no es la palabra correcta');
                    }

            }else if(questionAsked2.includes(questions2[i].question.c)) {
                        if (questions2[i].answer.c===responseUpper){
                            count ===1 ? console.log('Correcto, tienes ' + count + ' punto') : console.log('Correcto, tienes ' + count + ' puntos');
                            count++;
                            questions2[i].status=1;
                            statusRight += questions2[i].status===1;
                        }  
                        else{
                            questions2[i].status=2;
                            statusWrong += questions2[i].status===2;
                            console.log('Error,' + response + ' no es la palabra correcta');
                        }

               //aqu√≠ se compara las respuestas acertadas con la letra recogida         
            }else if (responseUpper===questions2[i].answer[letterVariable]){

                count ===1 ? console.log('Correcto, tienes ' + count + ' punto') : console.log('Correcto, tienes ' + count + ' puntos');
                count++;
                questions2[i].status=1;
                statusRight += questions2[i].status===1;

            }  //en caso de no coincidir la respuesta con nada
            else if (responseUpper!==questions2[i].answer[letterVariable]) {
            
                questions2[i].status=2;
                statusWrong += questions2[i].status===2;
                console.log('Error,' + response + ' no es la palabra correcta');
            }	


         
    
      
}//fin for loop

    //Mientras la variable end sea falsa (se ha creado con el valor false) se mostrar√°
    // el recueto y la puntuaci√≥n del usuario
    while (end===false) {
        console.log(`Se acabaron las palabras. Tu puntuaci√≥n es la siguiente:
        Has acertado ${statusRight} palabras
        Has fallado  ${statusWrong} palabras
        `);

        //sacar la puntuaci√≥n del usuario
        points= statusRight;
        rankingUsers.push({name, points});
        rankingUsers.forEach(function (elemento) {
            console.log(elemento);
        });
        //Pongo end a true para que solo muestre la puntuaci√≥ una vez 
        end=true;
    }//Fin while

 //limpiar los status del array questions y variables globales para el siguiente turno
 
 questions2.forEach(function(el){
    el.status=0;
       
 });  

 statusRight=0;
 statusWrong=0;
 count=1;
 end=false; 
 questionAsked='';
 questionAsked2=[];
 valor=-1;


//Funci√≥n que hace splice de la palabra con "pasapalabra" y la mete detr√°s del array 
function newTurn (index){
    
	var removedItemArray= questions2.splice(index,1 );
	   
	removedItemArray.forEach(function(el){
			questions2.push(el);
       });	
 }
    

} //Fin function askQuestons

} //Fin funci√≥n pasapalabra